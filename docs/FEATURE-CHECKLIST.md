# 功能完成清單

本文檔列出所有功能的完成條件與驗收準則。

---

## 功能模塊概覽

```
KoreKore 核心功能
├── 1️⃣ 菜單掃描 (Menu Scan)
├── 2️⃣ AI 解析 (AI Processing)
├── 3️⃣ 點餐介面 (Ordering UI)
├── 4️⃣ 點餐卡生成 (Order Card Generation)
├── 5️⃣ 菜單歷史 (Menu History)
├── 6️⃣ 用戶認證 (Authentication)
├── 7️⃣ 多語系支援 (Internationalization)
└── 8️⃣ 響應式設計 (Responsive Design)
```

---

## 功能 1: 菜單掃描 (Menu Scan)

**負責人：** 待指派

**優先級：** 🔴 P0 (核心功能)

**完成條件：**

- [ ] **頁面與組件**
  - [ ] 建立 `src/features/menu-scan/` 目錄結構
  - [ ] 實現 `MenuScanForm` 組件
  - [ ] 實現 `ImagePreview` 組件
  - [ ] 實現 `ProgressBar` 組件

- [ ] **功能實現**
  - [ ] 支援點擊上傳或拍攝
  - [ ] 支援拖放上傳
  - [ ] 圖片格式驗證 (JPG, PNG)
  - [ ] 檔案大小驗證 (≤ 5MB)
  - [ ] 圖片預覽

- [ ] **用戶體驗**
  - [ ] 顯示上傳進度條
  - [ ] 顯示加載狀態
  - [ ] 錯誤提示清晰

- [ ] **測試**
  - [ ] 單元測試：檔案驗證邏輯
  - [ ] 單元測試：圖片預覽
  - [ ] 組件測試：上傳流程

**驗收準則：**
- ✅ 用戶可成功上傳菜單圖片
- ✅ 無效圖片格式被拒絕，並顯示錯誤信息
- ✅ 圖片大於 5MB 時被拒絕
- ✅ 上傳完成後自動進入 AI 解析流程

---

## 功能 2: AI 解析 (AI Processing)

**負責人：** 待指派

**優先級：** 🔴 P0 (核心功能)

**完成條件：**

- [ ] **Gemini API 整合**
  - [ ] 建立 `src/services/geminiService.ts`
  - [ ] 實現 `parseMenuImage()` 函數
  - [ ] 實現 Prompt 範本（中文 + 英文）
  - [ ] 實現響應驗證與 Schema 檢查

- [ ] **錯誤處理**
  - [ ] 無效 API Key 時顯示配置錯誤
  - [ ] 網路錯誤可重試
  - [ ] Gemini API 錯誤可重試
  - [ ] 超時錯誤可重試

- [ ] **性能優化**
  - [ ] 實現重試邏輯（最多 3 次）
  - [ ] 實現超時控制（30 秒）
  - [ ] 實現錯誤日誌

- [ ] **UI 組件**
  - [ ] 實現 `AIProcessingIndicator` 組件
  - [ ] 顯示解析進度

- [ ] **測試**
  - [ ] Mock Gemini API 進行單元測試
  - [ ] 測試成功響應解析
  - [ ] 測試錯誤處理

**驗收準則：**
- ✅ 菜單圖片被成功解析
- ✅ 返回有效的 JSON 結構 (id, name, name_zh_TW, price)
- ✅ 解析失敗時顯示友善的重試提示
- ✅ API 超時時自動重試
- ✅ 日誌記錄所有 API 調用

---

## 功能 3: 點餐介面 (Ordering UI)

**負責人：** 待指派

**優先級：** 🔴 P0 (核心功能)

**完成條件：**

- [ ] **組件開發**
  - [ ] 建立 `src/features/ordering/` 目錄結構
  - [ ] 實現 `MenuCardList` 組件
  - [ ] 實現 `MenuCard` 組件（可勾選）
  - [ ] 實現 `OrderSummary` 組件

- [ ] **互動功能**
  - [ ] 點擊卡片勾選/取消
  - [ ] 實時更新已選數量
  - [ ] 實時計算選中菜單金額（若有價格）

- [ ] **樣式與響應式**
  - [ ] 卡片排版美觀
  - [ ] 適配手機、平板、桌面
  - [ ] 適配深色/淺色主題

- [ ] **無障礙性**
  - [ ] 使用語義化 HTML
  - [ ] 支援鍵盤導航
  - [ ] ARIA 標籤完整

- [ ] **測試**
  - [ ] 組件測試：卡片勾選
  - [ ] 組件測試：選中計數更新
  - [ ] 集成測試：完整點餐流程

**驗收準則：**
- ✅ 用戶可清晰查看菜單項目
- ✅ 用戶可勾選想點的菜品
- ✅ 已選菜品數量即時更新
- ✅ 介面在各設備上都易用

---

## 功能 4: 點餐卡生成 (Order Card Generation)

**負責人：** 待指派

**優先級：** 🔴 P0 (核心功能)

**完成條件：**

- [ ] **日文文字生成**
  - [ ] 建立 `src/features/order-card/` 目錄結構
  - [ ] 實現 `japaneseTextGenerator.ts` 工具
  - [ ] 支援敬語短語 (「これをください」等)
  - [ ] 生成完整點餐文字

- [ ] **UI 組件**
  - [ ] 實現 `OrderCardDisplay` 組件
  - [ ] 高對比度設計（易於秀給店員）
  - [ ] 大字體（易於識別）
  - [ ] 實現 `OrderCardActions` 組件

- [ ] **功能實現**
  - [ ] 複製文字到剪貼板
  - [ ] 下載為圖片 (PNG)
  - [ ] 分享功能 (Web Share API)

- [ ] **樣式**
  - [ ] 高對比度配色
  - [ ] 大字號（≥ 24px）
  - [ ] 足夠的間距

- [ ] **測試**
  - [ ] 單元測試：文字生成邏輯
  - [ ] 單元測試：圖片導出
  - [ ] 組件測試：複製與下載

**驗收準則：**
- ✅ 生成的日文文字正確且自然
- ✅ UI 高對比度，易於秀給店員
- ✅ 用戶可成功複製文字
- ✅ 用戶可下載為圖片
- ✅ 在主流瀏覽器上都能使用

---

## 功能 5: 菜單歷史 (Menu History)

**負責人：** 待指派

**優先級：** 🟡 P1 (重要功能)

**完成條件：**

- [ ] **本地存儲**
  - [ ] 建立 `src/features/menu-history/` 目錄結構
  - [ ] 實現 LocalStorage 存儲菜單歷史
  - [ ] 實現 LocalStorage 讀取菜單歷史

- [ ] **Firestore 存儲（登入後）**
  - [ ] 實現 `saveMenu()` 到 Firestore
  - [ ] 實現 `getUserMenus()` 從 Firestore
  - [ ] 實現菜單刪除

- [ ] **UI 組件**
  - [ ] 實現 `MenuGallery` 組件（相簿式展示）
  - [ ] 實現 `MenuGalleryItem` 組件
  - [ ] 實現 `MenuDetailView` 組件

- [ ] **功能**
  - [ ] 展示菜單圖片縮圖
  - [ ] 點擊查看菜單詳情
  - [ ] 刪除菜單記錄
  - [ ] 時間戳顯示

- [ ] **同步邏輯**
  - [ ] 未登入時只顯示本地歷史
  - [ ] 登入時自動合併本地 + Firestore 歷史
  - [ ] 新菜單自動同步到 Firestore

- [ ] **測試**
  - [ ] 單元測試：本地存儲操作
  - [ ] 集成測試：本地 → 雲同步

**驗收準則：**
- ✅ 用戶可查看本地菜單歷史
- ✅ 用戶可刪除菜單記錄
- ✅ 登入後可在其他裝置查看同步的菜單
- ✅ 菜單歷史超過 100 個時有分頁或虛擬滾動

---

## 功能 6: 用戶認證 (Authentication)

**負責人：** 待指派

**優先級：** 🟡 P1 (重要功能)

**完成條件：**

- [ ] **Firebase 設置**
  - [ ] 配置 Firebase 項目
  - [ ] 啟用 Anonymous Auth
  - [ ] 啟用 Email/Password Auth

- [ ] **匿名認證**
  - [ ] App 啟動時自動進行匿名認證
  - [ ] 取得並保存 Device/Anonymous ID
  - [ ] 無需用戶操作

- [ ] **登入 UI**
  - [ ] 實現登入表單
  - [ ] 實現註冊表單
  - [ ] 實現登出功能

- [ ] **狀態管理**
  - [ ] 監聽認證狀態變化
  - [ ] 存儲當前用戶信息
  - [ ] 提供用戶狀態選擇器

- [ ] **錯誤處理**
  - [ ] 郵箱已存在提示
  - [ ] 密碼過弱提示
  - [ ] 登入失敗提示

- [ ] **測試**
  - [ ] 單元測試：匿名認證流程
  - [ ] 單元測試：郵箱登入流程

**驗收準則：**
- ✅ App 啟動時自動進行匿名認證
- ✅ 用戶可成功登入/註冊
- ✅ 登入後可在主菜單看到登出選項
- ✅ 登出後回到匿名狀態

---

## 功能 7: 多語系支援 (Internationalization)

**負責人：** 待指派

**優先級：** 🟡 P1 (重要功能)

**完成條件：**

- [ ] **語言設置**
  - [ ] 建立 i18n 配置
  - [ ] 支援繁體中文 (zh_TW)
  - [ ] 支援英文 (en)

- [ ] **翻譯文件**
  - [ ] 建立 `zh_TW.json` 翻譯
  - [ ] 建立 `en.json` 翻譯
  - [ ] 覆蓋所有 UI 文本

- [ ] **UI 實現**
  - [ ] 實現語言切換按鈕
  - [ ] 持久化語言選擇到 LocalStorage
  - [ ] 登入用戶的語言偏好存到 Firestore

- [ ] **Gemini Prompt**
  - [ ] 根據語言切換 Prompt 模板
  - [ ] 中文 Prompt 要求中文翻譯
  - [ ] 英文 Prompt 要求英文翻譯

- [ ] **測試**
  - [ ] 單元測試：語言切換
  - [ ] 組件測試：i18n 集成

**驗收準則：**
- ✅ UI 支援中英文切換
- ✅ 菜單解析根據語言選擇生成對應翻譯
- ✅ 語言選擇被持久化
- ✅ 所有文本都被翻譯，無硬編碼的英文

---

## 功能 8: 響應式設計 (Responsive Design)

**負責人：** 待指派

**優先級：** 🟡 P1 (重要功能)

**完成條件：**

- [ ] **斷點支援**
  - [ ] 手機 (< 640px)：單列佈局
  - [ ] 平板 (640-1024px)：2 列佈局
  - [ ] 桌面 (> 1024px)：3 列或更多

- [ ] **可觸摸性**
  - [ ] 觸摸目標大小 ≥ 44×44px
  - [ ] 按鈕間距足夠

- [ ] **圖片優化**
  - [ ] 根據屏幕尺寸加載適當分辨率
  - [ ] 支援 WebP 格式（帶降級）

- [ ] **測試**
  - [ ] 視覺回歸測試（不同屏幕尺寸）
  - [ ] 觸摸交互測試

**驗收準則：**
- ✅ 應用在各屏幕尺寸上都易用
- ✅ 無需橫向滾動（除非必要）
- ✅ 觸摸目標足夠大
- ✅ 圖片加載速度快

---

## 功能 9: 性能優化 (Performance)

**負責人：** 待指派

**優先級：** 🟡 P1 (重要功能)

**完成條件：**

- [ ] **Bundle 優化**
  - [ ] 初始 Bundle 大小 < 150KB (gzip)
  - [ ] 實現代碼分割

- [ ] **運行時性能**
  - [ ] Lighthouse 性能評分 > 80
  - [ ] 首屏加載時間 < 2s
  - [ ] 互動延遲 < 100ms

- [ ] **圖片優化**
  - [ ] 圖片轉換為 WebP
  - [ ] 使用 srcset 進行響應式加載
  - [ ] 實現懶加載

- [ ] **測試**
  - [ ] 性能監控 (Web Vitals)
  - [ ] Bundle 分析

**驗收準則：**
- ✅ 應用加載快速
- ✅ 交互響應迅速
- ✅ 無明顯的卡頓或延遲

---

## 功能 10: 錯誤處理與日誌 (Error Handling & Logging)

**負責人：** 待指派

**優先級：** 🟢 P2 (支撐功能)

**完成條件：**

- [ ] **錯誤捕捉**
  - [ ] 所有 API 調用有 try-catch
  - [ ] 所有非同步操作有錯誤邊界
  - [ ] 全局錯誤邊界 Component

- [ ] **用戶提示**
  - [ ] 所有錯誤都有用戶友善的提示
  - [ ] 支援重試選項
  - [ ] 清晰的錯誤信息

- [ ] **日誌**
  - [ ] 重要事件記錄日誌
  - [ ] 錯誤日誌包含堆棧跟蹤
  - [ ] 可配置日誌級別

- [ ] **測試**
  - [ ] 單元測試：錯誤邊界

**驗收準則：**
- ✅ 應用不會因未捕捉錯誤而崩潰
- ✅ 用戶始終知道發生了什麼
- ✅ 開發者可通過日誌調試問題

---

## 功能 11: 無障礙性 (Accessibility)

**負責人：** 待指派

**優先級：** 🟢 P2 (支撐功能)

**完成條件：**

- [ ] **語義化 HTML**
  - [ ] 使用語義標籤 (`<button>`, `<nav>`, etc)
  - [ ] 避免用 `<div>` 模擬按鈕

- [ ] **ARIA 標籤**
  - [ ] 複雜組件有 ARIA 標籤
  - [ ] 表單字段有關聯的 label

- [ ] **鍵盤導航**
  - [ ] Tab 鍵可遍歷所有交互元素
  - [ ] Focus 指示清晰

- [ ] **對比度**
  - [ ] 文字與背景對比度 ≥ 4.5:1

- [ ] **測試**
  - [ ] WAVE 或 Lighthouse 無障礙審計
  - [ ] 鍵盤導航測試

**驗收準則：**
- ✅ 應用符合 WCAG 2.1 AA 標準
- ✅ 屏幕閱讀器用戶可正常使用

---

## 全局檢查清單

**發佈前必須完成：**

- [ ] 所有 P0 功能完成並通過測試
- [ ] 所有 P1 功能完成並通過測試
- [ ] 沒有控制台 JavaScript 錯誤
- [ ] 沒有 TypeScript 類型錯誤
- [ ] Lighthouse 評分 > 80
- [ ] 無 A11y 問題
- [ ] README 更新完整
- [ ] 環境配置文檔完整
- [ ] .gitignore 包含敏感文件
- [ ] 最終 commit 與 merge

---

**最後更新：2025-12-17**
