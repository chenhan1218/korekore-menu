# èœå–®æƒæåŠŸèƒ½ - å¯¦ç¾è¨ˆåŠƒ

## æ¶æ§‹è¨­è¨ˆ

åŸºæ–¼ KoreKore çš„åˆ†å±¤æ¶æ§‹ï¼š
- **Domain Layer** (`src/domain/`)ï¼šèœå–®æƒæçš„æ¥­å‹™é‚è¼¯
- **Infrastructure Layer** (`src/infrastructure/`)ï¼šMock æ•¸æ“šæœå‹™ã€API å‘¼å«
- **UI Layer** (`src/ui/components/`)ï¼šä¸Šå‚³å’Œèœå–®å±•ç¤ºçµ„ä»¶
- **Types** (`src/types/`)ï¼šå…±äº«çš„ TypeScript å‹åˆ¥å®šç¾©

---

## ğŸ“ å¯¦ç¾è¨ˆåŠƒè©³æƒ…

### Phase 1: åŸºç¤è¨­æ–½èˆ‡å‹åˆ¥å®šç¾© [checkpoint: ]

æ­¤éšæ®µç›®æ¨™ï¼šå»ºç«‹å®Œæ•´çš„å‹åˆ¥ç³»çµ±å’Œ Mock æ•¸æ“šæœå‹™ï¼Œç‚ºå¾ŒçºŒçµ„ä»¶é–‹ç™¼å¥ å®šåŸºç¤ã€‚

- [x] Task: å»ºç«‹èœå–®é …ç›®å‹åˆ¥å®šç¾© (`MenuItemType`, `VariantType` ç­‰) [31da4d6]
  - [x] Write tests: é©—è­‰å‹åˆ¥çµæ§‹å’Œæ•¸æ“šé©—è­‰é‚è¼¯
  - [x] Implement: åœ¨ `src/types/menu.ts` ä¸­å®šç¾©å‹åˆ¥
  - [x] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼šæ­£ç¢ºçµæ§‹ã€ç¼ºå¤±æ¬„ä½ã€åƒ¹æ ¼æ ¼å¼é©—è­‰

- [x] Task: å¯¦ç¾ Mock èœå–®æ•¸æ“šæœå‹™ [d3124d8]
  - [x] Write tests: é©—è­‰ Mock æ•¸æ“šè¿”å› 20 å€‹æ­£ç¢ºæ ¼å¼çš„èœé …
  - [x] Implement: åœ¨ `src/infrastructure/mockMenuService.ts` ä¸­å»ºç«‹æœå‹™
  - [x] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼šæ•¸æ“šå®Œæ•´æ€§ã€ID å”¯ä¸€æ€§ã€variants é™£åˆ—é©—è­‰

- [x] Task: å»ºç«‹èœå–®æƒæé ˜åŸŸé‚è¼¯ (`MenuScanDomain`) [ed466c8]
  - [x] Write tests: é©—è­‰ä¸Šå‚³åœ–ç‰‡å¾Œèƒ½æ­£ç¢ºèª¿ç”¨ Mock æœå‹™
  - [x] Implement: åœ¨ `src/domain/menuScan.ts` ä¸­å»ºç«‹é‚è¼¯
  - [x] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼šæˆåŠŸæƒæã€å¤±æ•—æƒ…æ³ã€æ•¸æ“šè½‰æ›

- [ ] Task: Phase 1 é©—è­‰
  - [ ] åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶ï¼Œç¢ºä¿æ‰€æœ‰å‹åˆ¥å’Œæœå‹™é€šéæ¸¬è©¦
  - [ ] é©—è­‰ä»£ç¢¼è¦†è“‹ç‡ >80%
  - [ ] æª¢æŸ¥å‹åˆ¥å®‰å…¨æ€§å’Œ ESLint è¦å‰‡

---

### Phase 2: ä¸Šå‚³åŠŸèƒ½å¯¦ç¾ [checkpoint: ]

æ­¤éšæ®µç›®æ¨™ï¼šå¯¦ç¾èœå–®åœ–ç‰‡ä¸Šå‚³çš„ UI å’Œé‚è¼¯ï¼Œæ”¯æ´ JPG/PNGï¼Œè‡ªå‹•å£“ç¸®è¶… 5MB çš„åœ–ç‰‡ã€‚

- [ ] Task: å¯¦ç¾åœ–ç‰‡å£“ç¸®å·¥å…·å‡½æ•¸
  - [ ] Write tests: é©—è­‰åœ–ç‰‡å£“ç¸®åŠŸèƒ½
  - [ ] Implement: åœ¨ `src/shared/imageCompression.ts` ä¸­å»ºç«‹å·¥å…·
  - [ ] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼š
    - è¶…é 5MB çš„åœ–ç‰‡æ­£ç¢ºå£“ç¸®è‡³ 5MB ä»¥ä¸‹
    - JPEG å“è³ªè¨­ç½®ç‚º 85-90%
    - å°æ–¼ 5MB çš„åœ–ç‰‡ä¿æŒä¸è®Š
    - ä¸æ”¯æ´çš„æ ¼å¼æ­£ç¢ºæ‹’çµ•

- [ ] Task: å¯¦ç¾åœ–ç‰‡ä¸Šå‚³çµ„ä»¶ (`MenuUploadInput`)
  - [ ] Write tests: é©—è­‰æª”æ¡ˆé¸æ“‡ã€æ ¼å¼é©—è­‰ã€å¤§å°æª¢æŸ¥
  - [ ] Implement: åœ¨ `src/ui/components/MenuUploadInput.tsx` ä¸­å»ºç«‹çµ„ä»¶
  - [ ] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼š
    - æ”¯æ´ JPG/PNG é¸æ“‡
    - æ‹’çµ•ä¸æ”¯æ´çš„æ ¼å¼ (.gif, .bmp ç­‰)
    - æª”æ¡ˆ >15MB æ™‚é¡¯ç¤ºéŒ¯èª¤
    - æˆåŠŸé¸æ“‡å¾Œæ­£ç¢ºå›å‚³æª”æ¡ˆ

- [ ] Task: å¯¦ç¾ä¸Šå‚³é€²åº¦åé¥‹
  - [ ] Write tests: é©—è­‰ä¸Šå‚³ç‹€æ…‹ç®¡ç† (idle, compressing, uploading, success, error)
  - [ ] Implement: ä¸Šå‚³éç¨‹ä¸­é¡¯ç¤ºåŠ è¼‰ç‹€æ…‹ã€æˆåŠŸ/å¤±æ•—æç¤º
  - [ ] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼š
    - ç‹€æ…‹æ­£ç¢ºè½‰æ›
    - éŒ¯èª¤æ¶ˆæ¯å‹å–„æ¸…æ™°
    - Loading å‹•ç•«æ­£å¸¸é¡¯ç¤º
    - å£“ç¸®é€²åº¦æ­£ç¢ºåé¥‹

- [ ] Task: æ•´åˆä¸Šå‚³èˆ‡ Mock æœå‹™
  - [ ] Write tests: é©—è­‰ä¸Šå‚³åœ–ç‰‡å¾Œç«‹å³è¿”å› Mock æ•¸æ“š
  - [ ] Implement: åœ¨ `MenuUploadInput` ä¸­å‘¼å« `mockMenuService`
  - [ ] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼š
    - æ¨¡æ“¬ä¸Šå‚³æˆåŠŸå¾Œè¿”å› Mock æ•¸æ“š
    - é©—è­‰æ•¸æ“šçµæ§‹æ­£ç¢º
    - ç•°æ­¥æµç¨‹æ­£ç¢ºè™•ç†

- [ ] Task: Phase 2 é©—è­‰
  - [ ] åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶
  - [ ] é©—è­‰ä»£ç¢¼è¦†è“‹ç‡ >80%
  - [ ] æª¢æŸ¥ Tailwind CSS æ¨£å¼å’ŒéŸ¿æ‡‰å¼è¨­è¨ˆ

---

### Phase 3: èœå–®å±•ç¤ºèˆ‡äº’å‹• [checkpoint: ]

æ­¤éšæ®µç›®æ¨™ï¼šå¯¦ç¾èœå–®å¡ç‰‡å±•ç¤ºï¼Œæ”¯æ´è¦æ ¼é¸æ“‡å’Œå‹¾é¸åŠŸèƒ½ã€‚

- [ ] Task: å¯¦ç¾èœå–®é …ç›®å¡ç‰‡çµ„ä»¶ (`MenuItemCard`)
  - [ ] Write tests: é©—è­‰èœé …ä¿¡æ¯æ­£ç¢ºå±•ç¤º
  - [ ] Implement: åœ¨ `src/ui/components/MenuItemCard.tsx` ä¸­å»ºç«‹çµ„ä»¶
  - [ ] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼š
    - èœåã€ä¸­æ–‡ç¿»è­¯æ­£ç¢ºé¡¯ç¤º
    - è¦æ ¼é¸é …å’Œå°æ‡‰åƒ¹æ ¼æ­£ç¢ºå±•ç¤º
    - ã€Œç¨…è¾¼ã€æˆ–ã€Œç¨…æ‹”ã€æ¨™ç±¤æ¸…æ¥šé¡¯ç¤º
    - UI åœ¨ä¸åŒè¢å¹•å°ºå¯¸ä¸Šå¯è®€

- [ ] Task: å¯¦ç¾èœå–®æ¸…å–®çµ„ä»¶ (`MenuList`)
  - [ ] Write tests: é©—è­‰ 20 å€‹èœé …å¡ç‰‡æ­£ç¢ºæ¸²æŸ“
  - [ ] Implement: åœ¨ `src/ui/components/MenuList.tsx` ä¸­å»ºç«‹çµ„ä»¶
  - [ ] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼š
    - æ‰€æœ‰èœé …å¡ç‰‡æ­£ç¢ºæ¸²æŸ“
    - ç©ºåˆ—è¡¨æ™‚é¡¯ç¤ºé©ç•¶æ¶ˆæ¯
    - åˆ—è¡¨æ»¾å‹•é †æš¢

- [ ] Task: å¯¦ç¾èœé …å‹¾é¸èˆ‡ç‹€æ…‹ç®¡ç†
  - [ ] Write tests: é©—è­‰ç”¨æˆ¶å‹¾é¸èœé …çš„ç‹€æ…‹è®ŠåŒ–
  - [ ] Implement: ä½¿ç”¨ Zustand å»ºç«‹èœå–®ç‹€æ…‹ store (`src/domain/stores/menuStore.ts`)
  - [ ] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼š
    - å‹¾é¸/å–æ¶ˆå‹¾é¸å·¥ä½œæ­£å¸¸
    - è¦æ ¼é¸æ“‡å·¥ä½œæ­£å¸¸
    - ç‹€æ…‹æ›´æ–°æ­£ç¢ºå‚³éåˆ° UI

- [ ] Task: Phase 3 é©—è­‰
  - [ ] åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶
  - [ ] é©—è­‰ä»£ç¢¼è¦†è“‹ç‡ >80%
  - [ ] æ‰‹å‹•æ¸¬è©¦ï¼šé»æ“Šå‹¾é¸ã€é¸æ“‡è¦æ ¼ã€æª¢è¦–èœå–®æµæš¢åº¦

---

### Phase 4: å®Œæ•´é›†æˆèˆ‡æ‡‰ç”¨ [checkpoint: ]

æ­¤éšæ®µç›®æ¨™ï¼šå°‡èœå–®æƒæåŠŸèƒ½æ•´åˆé€²ä¸»æ‡‰ç”¨ï¼Œå®Œæˆç«¯åˆ°ç«¯æµç¨‹ã€‚

- [ ] Task: å»ºç«‹èœå–®æƒæé é¢ (`MenuScanPage`)
  - [ ] Write tests: é©—è­‰é é¢åŠ è¼‰ã€ä¸Šå‚³ã€èœå–®é¡¯ç¤ºçš„å®Œæ•´æµç¨‹
  - [ ] Implement: åœ¨ `src/ui/pages/MenuScanPage.tsx` ä¸­å»ºç«‹é é¢
  - [ ] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼š
    - åˆå§‹ç‹€æ…‹ï¼ˆä¸Šå‚³ç•Œé¢ï¼‰
    - ä¸Šå‚³å¾Œæ­£ç¢ºé¡¯ç¤ºèœå–®
    - ç”¨æˆ¶äº’å‹•ï¼ˆå‹¾é¸ã€é¸æ“‡è¦æ ¼ï¼‰
    - éŒ¯èª¤æƒ…æ³ï¼ˆä¸Šå‚³å¤±æ•—ï¼‰

- [ ] Task: æ•´åˆåˆ°ä¸»æ‡‰ç”¨è·¯ç”±
  - [ ] Write tests: é©—è­‰è·¯ç”±å°èˆªæ­£å¸¸
  - [ ] Implement: åœ¨ `src/App.tsx` ä¸­æ·»åŠ èœå–®æƒæè·¯ç”±
  - [ ] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼š
    - å¾é¦–é å¯å°èˆªåˆ°èœå–®æƒæ
    - URL åƒæ•¸è™•ç†ï¼ˆå¦‚æœ‰ï¼‰
    - é é¢åˆ‡æ›æµæš¢

- [ ] Task: å®Œæ•´åŠŸèƒ½æ•´åˆæ¸¬è©¦
  - [ ] Write tests: æ¨¡æ“¬å®Œæ•´ç”¨æˆ¶æµç¨‹
  - [ ] Implement: åœ¨ `src/ui/pages/__tests__/MenuScanPage.integration.test.tsx` ä¸­å»ºç«‹
  - [ ] æ¸¬è©¦æ‡‰æ¶µè“‹ï¼š
    - ç”¨æˆ¶ä¸Šå‚³åœ–ç‰‡ â†’ æŸ¥çœ‹èœå–® â†’ å‹¾é¸èœé … â†’ é¸æ“‡è¦æ ¼
    - éŒ¯èª¤æƒ…æ³çš„å®Œæ•´æµç¨‹
    - é é¢æ€§èƒ½

- [ ] Task: ä»£ç¢¼å“è³ªæª¢æŸ¥
  - [ ] åŸ·è¡Œ TypeScript å‹åˆ¥æª¢æŸ¥
  - [ ] åŸ·è¡Œ ESLint ä¸¦ä¿®å¾©æ‰€æœ‰è­¦å‘Š
  - [ ] åŸ·è¡Œä»£ç¢¼æ ¼å¼åŒ– (Prettier)
  - [ ] é©—è­‰æ‰€æœ‰æ–‡ä»¶éƒ½ç¬¦åˆä»£ç¢¼é¢¨æ ¼

- [ ] Task: Phase 4 é©—è­‰ âœ…
  - [ ] åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶ï¼Œç¢ºä¿æ‰€æœ‰æ¸¬è©¦é€šé
  - [ ] é©—è­‰ä»£ç¢¼è¦†è“‹ç‡ >80%
  - [ ] æ‰‹å‹•æ¸¬è©¦ï¼šå®Œæ•´çš„èœå–®æƒææµç¨‹
  - [ ] æª¢æŸ¥ TypeScript å‹åˆ¥å®‰å…¨
  - [ ] é©—è­‰ç§»å‹•è¨­å‚™ä¸Šçš„å¯ç”¨æ€§

---

## ğŸ¯ è³ªé‡é–˜é–€ (Quality Gates)

æ¯å€‹ Task å®Œæˆå‰å¿…é ˆç¢ºä¿ï¼š
- âœ… æ‰€æœ‰æ¸¬è©¦é€šé (`npm test`)
- âœ… ä»£ç¢¼è¦†è“‹ç‡ >80% (`npm run test:coverage`)
- âœ… ç„¡ TypeScript éŒ¯èª¤ (`npm run type-check`)
- âœ… ç„¡ ESLint è­¦å‘Š (`npm run lint`)
- âœ… ä»£ç¢¼å·²æ ¼å¼åŒ– (`npm run format`)

---

**ç‹€æ…‹**ï¼šâœ… è¨ˆåŠƒå·²æ‰¹å‡†
